[{"content":"The fight against phishing and spam emails is not restricted to incoming email filters and security solutions.\nAnyone sending email outbound likely has DNS records for email that can be locked down.\nRestrict SPF Update your list of servers or providers that can send mail on your behalf and then set the records to hard fail anything else.\nAdd DKIM Add DKIM singatures to ensure the integrity of the contents of emails\nConfigure DMARC policy Setup a DMARC policy to handle emails that appear to be forged/malicious.\nDMARCLY Guide on Implementing SPF/DKIM/DMARC\n","permalink":"https://galitz.github.io/posts/spf_dkim_dmarc/","summary":"The fight against phishing and spam emails is not restricted to incoming email filters and security solutions.\nAnyone sending email outbound likely has DNS records for email that can be locked down.\nRestrict SPF Update your list of servers or providers that can send mail on your behalf and then set the records to hard fail anything else.\nAdd DKIM Add DKIM singatures to ensure the integrity of the contents of emails","title":"Fighting the Phishers"},{"content":"Recent updates:\nAdded a tools link in github repo Updated the redblue examples repo with new content redblue-examples\n","permalink":"https://galitz.github.io/posts/repo-updates-aug2022/","summary":"Recent updates:\nAdded a tools link in github repo Updated the redblue examples repo with new content redblue-examples","title":"Repo Updates Aug 2022"},{"content":"Something often missed in security awareness training for users and customers is the account recovery secret question issue. The issue here is that if people treat them like \u0026ldquo;real questions,\u0026rdquo; and therefore answer honestly it can end up putting their account at risk.\nConsider a common recovery question: \u0026ldquo;What was the name of your first pet?\u0026rdquo; How many \u0026ldquo;Mr Socks\u0026rdquo; could there be in the universe? Well, it turns out quite a few. So that makes it a popular guess for account takeover (ATO) actors. Even more so, gizillions of people post on social media sites events in their lives\u0026hellip; popular on the reddit cat channel, for example, is people posting the passing of their beloved friend. But that means a deeper web/social media search could turn up the name of your first pet; and now your answer is not so secret.\nI generally recommend that folks use a non-sequitur answer to such questions. Things like:\nSecret Question #1: What is the name of your first pet? Answer: 59 Nice and short, and no amount of research by a malicious actor will turn up the answer to that!\n","permalink":"https://galitz.github.io/posts/cred-recovery-secret-question/","summary":"Something often missed in security awareness training for users and customers is the account recovery secret question issue. The issue here is that if people treat them like \u0026ldquo;real questions,\u0026rdquo; and therefore answer honestly it can end up putting their account at risk.\nConsider a common recovery question: \u0026ldquo;What was the name of your first pet?\u0026rdquo; How many \u0026ldquo;Mr Socks\u0026rdquo; could there be in the universe? Well, it turns out quite a few.","title":"Credential Recovery Secret Questions"},{"content":"Credential hunting is relevant to anyone in the infosec/cybersecurity space.\nI\u0026rsquo;ll spare you the long and probably unneeed introduction you get on most blogs and websites. Let\u0026rsquo;s just say that if you commit login credentials to your code or data repositories in plaintext, it is only a matter of time before they are found by malicious actors and used against you.\nSo\u0026hellip; what to do?\nUnder the assumption there may already be credentials from the past in your repositories and sometime in the future some might accidentally get commited, the thing to do is scan for them on a regular basis.\nThere\u0026rsquo;s a number of options, but my go to on this is gitleaks. https://github.com/zricethezav/gitleaks\nThe primary reason is the ability to scan the git commit history. Even if your current code gets cleaned up, the credentials are still visible in the commit history.\nHere is a cleaned up commit:\nRed-blue example 1\nLet\u0026rsquo;s see if we can find the password in the history:\nand here are the links provided by gitleaks:\nRed-blue example 2\nLesson learned: Credentials could be living in unexpected places in your code repositories.\n","permalink":"https://galitz.github.io/posts/gitleaks_1/","summary":"Credential hunting is relevant to anyone in the infosec/cybersecurity space.\nI\u0026rsquo;ll spare you the long and probably unneeed introduction you get on most blogs and websites. Let\u0026rsquo;s just say that if you commit login credentials to your code or data repositories in plaintext, it is only a matter of time before they are found by malicious actors and used against you.\nSo\u0026hellip; what to do?\nUnder the assumption there may already be credentials from the past in your repositories and sometime in the future some might accidentally get commited, the thing to do is scan for them on a regular basis.","title":"Credential hunting with gitleaks"},{"content":"Following up on a previous post on splunk and threat hunting, let\u0026rsquo;s go a step further. We demonstrated a query to show us attempted logins against joomla admin page. We saw what the attempted credentials were, but this resulted in so many lines of output that we couldn\u0026rsquo;t easily compile a list of IPs that we could identify as malicious.\nHere is the original query we talked about:\nindex=botsv1 earliest=0 http_method=POST uri=\u0026#34;/joomla/administrator/index.php\u0026#34; site=\u0026#34;imreallynotbatman.com\u0026#34; src_ip=\u0026#34;23.22.63.114\u0026#34; | table timestamp,form_data If we modify it to remove the table and the src_ip (which was just for example purposes) and add a counter like this:\nindex=botsv1 earliest=0 http_method=POST uri=\u0026#34;/joomla/administrator/index.php\u0026#34; site=\u0026#34;imreallynotbatman.com\u0026#34; | stats count by src_ip We\u0026rsquo;ll get a breakdown of activity to that URI by source IP. Be careful here though, this will also count valid login traffic.\n","permalink":"https://galitz.github.io/posts/threat_hunting_2/","summary":"Following up on a previous post on splunk and threat hunting, let\u0026rsquo;s go a step further. We demonstrated a query to show us attempted logins against joomla admin page. We saw what the attempted credentials were, but this resulted in so many lines of output that we couldn\u0026rsquo;t easily compile a list of IPs that we could identify as malicious.\nHere is the original query we talked about:\nindex=botsv1 earliest=0 http_method=POST uri=\u0026#34;/joomla/administrator/index.","title":"Threat hunting with splunk: sorting by IP"},{"content":"Over in my useful_snippets repo, I just added a neat little example:\nindex=botsv1 earliest=0 http_method=POST uri=\u0026#34;/joomla/administrator/index.php\u0026#34; site=\u0026#34;imreallynotbatman.com\u0026#34; src_ip=\u0026#34;23.22.63.114\u0026#34; | table timestamp,form_data It uses the botsv1 example dataset (provided by splunk), searches the entire history of the dataset for specified URL and sie. It then creates a table with timestamp and the form data as passed in by the browser. This is an example, but you can build off it to manually inspect what users and passwords are being targetted by malicious actors.\n","permalink":"https://galitz.github.io/posts/splunk-botsv1-joomla-admin-example/","summary":"Over in my useful_snippets repo, I just added a neat little example:\nindex=botsv1 earliest=0 http_method=POST uri=\u0026#34;/joomla/administrator/index.php\u0026#34; site=\u0026#34;imreallynotbatman.com\u0026#34; src_ip=\u0026#34;23.22.63.114\u0026#34; | table timestamp,form_data It uses the botsv1 example dataset (provided by splunk), searches the entire history of the dataset for specified URL and sie. It then creates a table with timestamp and the form data as passed in by the browser. This is an example, but you can build off it to manually inspect what users and passwords are being targetted by malicious actors.","title":"Threat hunting with splunk: simple credential attacks"},{"content":"Here is a link to some useful code/cli snippets and one-liners for various situations:\nUseful Snippets\n","permalink":"https://galitz.github.io/posts/useful-links/","summary":"Here is a link to some useful code/cli snippets and one-liners for various situations:\nUseful Snippets","title":"Useful snippets and one-liners"}]